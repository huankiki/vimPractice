# vimBasics
vim基本用法——入门篇

#### vim -u NONE -N
vimrc的设置和插件均被禁用。设置为vi非兼容模式。  
-u NONE 标志让 Vim 在启动时不加载你的 vimrc，这样，你的定制项就不会生
效，**插件也会被禁用**。当用不加载 vimrc 文件的方式启动时， Vim 会切换到 vi 兼
容模式，这将导致很多有用的功能被禁用，而 -N 标志则会使能 ‘nocompatible’ 选
项，防止进入 vi 兼容模式。

#### vim -u bookcode/essential.vim
激活了内置的插件功能，并且禁用了 vi 兼容模式。

#### :version
查看vim的版本（需要打开vim后查看）。

#### :h vimtutor
查看Vim的内置文档。  
也可以用`：h`来查看帮助文档，比如`:h .`查看`.`的介绍。

#### 技巧1 `.` Repeat last change/重复上次修改
这里提到的"上次修改"是两个ESC之间的所有操作。

#### 技巧2 `A` 相当于 `$a`，一箭双雕
`a` 命令在当前光标之后添加内容，而 `A` 命令则在当前行的结尾添加内容。不管光
标当前处于什么位置，输入 A 都会进入插入模式，并把光标移到行尾。换句话说，它
把 `$a` 封装成了一个按键操作。

#### 技巧3 `f{char}` & `；` & `s`
- `f{char}`，查找下一处指定字符出现的位
置，如果找到了，就直接把光标移到那里。
- `；`，重复查找上次 `f` 命令所查找的字符。
- `s`，先删除光标下的字符，然后进入插入模式。把以上两个操作合并为一个。  

![skill_3](./graph/skill_3.png)

#### 技巧4 `u`，撤销，undo
![skill_4](./graph/skill_4.png)

#### 技巧5 `*` 单键命令，在匹配项间跳转
- 全局替换: `%s/content/copy/g`
- 查找提示符 + 待查找的单词，example: `/content`
- 把光标移到单词上，然后按 `*` 键，无需输入就可以进行查找
  - 光标会跳到下一个匹配项上
  - 所有出现这个词的地方都会被高亮显示出来
  - 按 `n` 键就可以跳到下一个匹配项，按 `N` 键就可以跳到上一个匹配项
- `cw` 命令会删除从光标位置到单词结尾间的字符，并进入插入模式

------
### 普通模式(normal mode)
一次修改：从进入插入模式开始，直到退出此模式，返回普通模式为止，在此期间输入或者删除的任何内容。

#### 技巧8 把撤销单元切成块
`u` 命令为撤销命令，会撤销最新的修改，可能是字符、单词、句子、段落。  
在vim中，可以自己控制撤销命令的粒度。这种把握度需要对vim足够的熟悉。

#### 技巧9 构造可重复的修改
最后一个方案是最佳的，因为不仅删除了单词，还会删除一个空格，最后光标停在单词 is 的最后一个字符上。如果此时使用`.`命令，它会重复上次删除单词的命令。即可重复的修改。
![skill_9](./graph/skill_9.png)
- `db`，删除从光标起始位置到单词开头的内容，但会原封未动地留下最后一个字符
- `x`，删除光标所在字符
- `b`，把光标移到单词的开头，即back
- `dw`，delete word，删除整个单词
- `daw`，delete a word，其中`aw`是一个文本对象

#### 技巧10 `<C-a>` 和 `<C-x>` 命令分别对数字执行加、减操作
例如，把光标移到字符 5 上，执行 `10<C-a>`就会把它变成 15。
- `yyp`，复制+粘贴光标所在的行

#### 技巧11 `d2w`次数风格 or `dw.`重复风格
|执行|重复|回退|
|-|-|-|
|`d2w`, `2dw`|`.`，每次删除两个单词|u|
|`dw.`|`.`，每次删除一个单词|`uu`，`2u`|  

取决于你怎么看保留干净撤销历史记录的价值，以及你是否觉得用次数令人生厌。  

#### 技巧12 操作符 + 动作命令 = 操作，双剑合璧天下无敌
`d{motion}` 命令可以对一个字符（`dl`）、一个完整单词（`daw`）或一整个段落（`dap`）进行操作，它作用的范围由动作命令决定。 c{motion}、 y{motion}以及其他一些命令也类似，它们被统称为操作符（operator）。你可以用`:h operator` 来查阅完整的列表。  
![skill_12](./graph/skill_12_operator.png)  

Vim 的语法只有一条额外规则，即**当一个操作符命令被连续调用两次时，它会作用于当前行。  
所以 `dd` 删除当前行， `>>` 缩进当前行。**

------
### 插入模式(insert mode)

#### 技巧13 在插入模式中删除
- `Ctrl h`，删除前一个字符，同退格键
- `Ctrl w`，删除前一个单词
- `Ctrl u`，删除至行首

#### 技巧14 返回普通模式
`Ctrl [`，效果同`ESC`，切换到普通模式。

#### 技巧18，替换模式
`R` 命令可以由普通模式进入替换模式，完成替换后，就可以按 `<Esc>` 键返回普通模式。  
如果键盘上有 `<Insert>` 键，那么也可以用该键在插入模式和替换模式间切换。

------
### 可视模式
Vim的可视模式允许我们选中一块文本区域并在其上进行操作。Vim具有3种不同的可视模式，分别用于操作字符文本、行文本或块文本。
- 很多普通模式的命令，在可视模式中也完成相同的功能
- 某些可视模式命令执行的基本功能与普通模式相同，但操作上有些细微的变化。  
例如，在这两种模式中， `c` 命令的功能是一样的，都是删除指定的文本并切换到插入模式。不过，要指定其所操作的范围，二者的方式却不甚相同。在普通模式中，我们先触发修改命令，然后使用动作命令指定其作用范围，然而在可视模式中，我们先选中选区，然后再触发修改命令。
- 例子，把单词“March”修改为“April”
  - 先把光标移到单词“March”的某个位置
  - 执行 `viw` 高亮选择这个词
  - 用 `c` 命令修改所选内容，即把这个单词删掉并进入插入模式
  - 然后输入“April”

#### 技巧21 选择高亮选区
在普通模式下，激活可视模式的方法如下。由可视模式回到普通模式的方法与插入模式相同，即`<Esc>`或者`Ctrl-[`。  
![](./graph/skill_21.png)  
**切换选区的活动端**  
高亮选区的范围由其两个端点界定。其中一端固定，而另一端可以随光标自由移动，我们可以用 **`o` 键来切换其活动的端点**，并调整选区的边界。

#### 技巧22 `.`命令可以重复执行面向行的可视命令
当使用 `.` 命令重复对高亮选区所做的修改时，此修改会重复作用于相同范围的文本。  
![](./graph/skill_22.png)

#### 技巧24 以列为单位的文本操作
- `Ctrl-v`，进入列块可视模式
- `gv`命令重选上次的高亮选区
- `r{char}`，Replace the character under the cursor with {char}，用新字符`{char}`替换光标选中的每个位置的内容  
![](./graph/skill_24.png)

#### 技巧25/26 修改列文本
用列块可视模式可以同时往若干行中插入文本。  
当我们在插入模式中输入单词“components”时，此单词只出现在顶行，下面的两行没什么变化。只有在按了 <Esc> 返回到普通模式后，我们才看到刚才输入的文本出现在下面这两行里。  
![](./graph/skill_25.png)  

除了操作由行列组成的方形文本区域，还可以处理长短不一的情况。  
在每行的行尾添加分号。  
![](./graph/skill_26.png)

------
### 命令行模式
#### 技巧27 结识 Vim的命令行模式
在按下 `:` 键时，Vim 会切换到命令行模式，然后按 `<ENTER>` 执行它。在任意时刻，我们都可以按 `<Esc>`键从命令行模式切换回普通模式。  
我们可以用 Ex 命令读写文件（ :edit 和 :write ），创建新标签页（:tabnew ）及分割窗口（ :split ）。参见 `:h ex-cmd-index` 可获得完整列表。

#### 技巧28 在指定的范围执行命令
- 用行号作为地址
  - **`:1`，跳到第1行**
  - `:5`，跳到第5行
  - **`:$`，跳到最后一行**
  - `:3d`，跳到第3行，并删除此行  

- 用地址指定一个范围
  - `:2,5d`，删除第2到第5行，包含第2和第5行
  - `:{start},{end}`
  - **`.`，表示当前行的地址。`%`，当前文件的所有行**
  - `:.,$d`
  - `:.,.+3d`
